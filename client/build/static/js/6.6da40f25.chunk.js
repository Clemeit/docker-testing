(this.webpackJsonpddo_audit=this.webpackJsonpddo_audit||[]).push([[6],{478:function(e,t,i){"use strict";i(0);var n=i(76),r=i(1);t.a=function(e){return Object(r.jsx)("div",{className:"show-on-mobile",style:{display:"flex",flexDirection:"row",justifyContent:"center",width:"100%"},children:Object(r.jsxs)("p",{style:{fontSize:"1.5rem",lineHeight:"normal",color:"var(--text-faded)",textAlign:"center"},children:[Object(r.jsx)(n.a,{style:{verticalAlign:"top"}}),"This page is not optimized for mobile browsing."]})})}},506:function(e,t,i){"use strict";i.r(t);var n=i(4),r=i(0),a=i.n(r),c=i(33),s=i(16),o=i(11),l=i(36),d=i(100),u=i(101),h=i(45),j=i(44),m=i(13),b=i(478),f=i(14),x=i(12),p=i(221),g=i(222),O=i(220),y=i(22),v=i.n(y),S=i(1),w=function(e){return Object(S.jsxs)("div",{className:"absolute-center",children:[Object(S.jsx)("div",{className:"overlay",onClick:function(){return e.close()}}),Object(S.jsxs)("div",{className:"popup-message fullscreen",style:{width:"600px",maxWidth:"90%"},children:[Object(S.jsx)(h.a,{className:"link-icon should-invert",style:{position:"absolute",top:"5px",right:"5px",cursor:"pointer"},onClick:function(){return e.close()}}),Object(S.jsx)("h3",{children:e.title||""}),e.message&&Object(S.jsx)("span",{style:{fontSize:"1.3rem"},children:e.message}),Object(S.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px"},children:[Object(S.jsx)("div",{className:"primary-button should-invert",style:{marginLeft:"auto",minWidth:"100px",textAlign:"center",marginTop:"10px"},onClick:function(){return e.yes()},children:"Yes"}),Object(S.jsx)("div",{className:"primary-button should-invert",style:{minWidth:"100px",textAlign:"center",marginTop:"10px"},onClick:function(){return e.no()},children:"No"})]})]})]})},k=function(){var e=a.a.useState(null),t=Object(n.a)(e,2),i=t[0],r=t[1],c=a.a.useState(),l=Object(n.a)(c,2),d=l[0],u=l[1],h=a.a.useState(!0),j=Object(n.a)(h,2),m=j[0],b=j[1],y=a.a.useState(!1),k=Object(n.a)(y,2),R=k[0],N=k[1],A=a.a.useState(!1),T=Object(n.a)(A,2),C=T[0],I=T[1],F=a.a.useState(-1),E=Object(n.a)(F,2),z=E[0],D=E[1],J=a.a.useState([]),B=Object(n.a)(J,2),L=B[0],H=B[1];a.a.useEffect((function(){var e=JSON.parse(localStorage.getItem("registered-characters")||"[]");r(e||[])}),[]),a.a.useEffect((function(){i&&P()}),[i]),a.a.useEffect((function(){L&&d&&W(d)}),[L]);var M=a.a.useRef(null);function P(){i&&0!==i.length?(b(!0),Object(x.b)("https://api.ddoaudit.com/players/lookup",{playerids:i},1e4).then((function(e){e.error?(b(!1),N(!0),Object(o.a)("Failed to fetch characters","".concat(e.error||"No error"))):(u(e),W(e))})).catch((function(){b(!1),N(!0),Object(o.a)("Failed to fetch characters","Timeout")}))):b(!1)}function W(e){null==e&&u([]);var t=[],i=[];e.forEach((function(n){i.push(Object(x.b)("https://api.ddoaudit.com/players/raidactivity",{playerid:n.PlayerId},1e4).then((function(e){t.push(Object(f.a)(Object(f.a)({},n),{},{RaidActivity:e}))})).catch((function(){b(!1),N(!0),t.push(e),Object(o.a)("Failed to fetch raid timers","Timeout for ".concat(n.Name))})))})),0!==i.length&&Promise.all(i).then((function(){t.forEach((function(e){e.RaidActivity=e.RaidActivity.filter((function(e){return e.remaining>0}))})),t.forEach((function(e){e.RaidActivity.sort((function(e,t){return e.remaining-t.remaining}));for(var t=[],i=function(i){t.includes(e.RaidActivity[i].name)?e.RaidActivity=e.RaidActivity.filter((function(e,t){return i!=t})):t.push(e.RaidActivity[i].name)},n=e.RaidActivity.length-1;n>=0;n--)i(n)})),t.forEach((function(e){e.RaidActivity=e.RaidActivity.filter((function(e){return!L.includes(e.id)}))})),t.sort((function(e,t){var i,n;return(null===(i=t.RaidActivity)||void 0===i?void 0:i.length)-(null===(n=e.RaidActivity)||void 0===n?void 0:n.length)})),u(t),b(!1)}))}function q(e){var t=e.remaining,i=Math.floor(t/86400);t%=86400;var n=Math.floor(t/3600);t%=3600;var r=Math.floor(t/60),a=[];return 0!=i&&a.push("".concat(i," day").concat(1!=i?"s":"")),0!=n&&a.push("".concat(n," hour").concat(1!=n?"s":"")),0!=r&&a.push("".concat(r," minute").concat(1!=r?"s":"")),a.join(", ")}return a.a.useEffect((function(){var e=JSON.parse(localStorage.getItem("hidden-raid-timer-ids")||"[]");return H(e),v()(document).on("keydown.handleEscape",(function(e){"Escape"===e.key&&I(!1)})),function(){return v()(document).unbind("keydown.handleEscape")}}),[]),Object(S.jsxs)("div",{children:[C&&Object(S.jsx)(w,{title:"Remove this raid timer?",message:"This will hide the current timer.",yes:function(){return function(){if(null!=z){var e=JSON.parse(localStorage.getItem("hidden-raid-timer-ids")||"[]");e.push(z),localStorage.setItem("hidden-raid-timer-ids",JSON.stringify(e||[])),H(e)}I(!1),D(null)}()},no:function(){return I(!1)},close:function(){return I(!1)}}),R&&Object(S.jsx)(O.a,{type:"error",title:"Failed to fetch character data",message:Object(S.jsxs)(S.Fragment,{children:["Please try again later. If the error persists, try clearing your browser cookies or let me know of the problem via the"," ",Object(S.jsx)(s.a,{to:"/suggestions",children:"Suggestions page"}),"."]}),submessage:"Reason: the server took too long to respond",fontSize:1.3,pushBottom:!0}),!m&&!R&&(!i||0==i.length)&&Object(S.jsx)(O.a,{type:"info",title:"No registered characters",message:Object(S.jsx)(S.Fragment,{children:"You need to add a character to track raid timers. Please click the button below."}),fontSize:1.3,pushBottom:!0}),d&&d.map((function(e,t){return Object(S.jsxs)("div",{children:[e&&Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)("div",{style:{padding:"10px 0px"},children:[Object(S.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginBottom:"10px"},children:[Object(S.jsxs)("h4",{style:{marginBottom:"0px",marginRight:"10px"},children:[e.Name," ",Object(S.jsxs)("span",{style:{color:"var(--text-faded)"},children:["| ",e.Server]})]}),Object(S.jsx)(p.a,{className:"nav-icon should-invert character-refresh-button",style:{cursor:"pointer"},onClick:function(){M.current+=360,v()(".character-refresh-button").css({transform:"rotate(".concat(M.current,"deg)")}),P()}})]}),!e.RaidActivity&&Object(S.jsx)("span",{style:{fontSize:"1.3rem",color:"var(--text-faded)"},children:R?"Failed to load":"Loading..."}),e.RaidActivity&&0==e.RaidActivity.length&&Object(S.jsx)("span",{style:{fontSize:"1.3rem",color:"var(--text-faded)"},children:"No raid timers on record"}),e.RaidActivity&&e.RaidActivity.length>0&&Object(S.jsxs)("table",{className:"character-table",style:{width:"100%"},children:[Object(S.jsx)("thead",{children:Object(S.jsxs)("tr",{style:{color:"var(--text-faded)",fontWeight:"bold",fontSize:"1.2rem",lineHeight:"15px"},children:[Object(S.jsx)("th",{style:{width:"30%"},children:"Raid"}),Object(S.jsx)("th",{style:{width:"65%"},children:"Timer"}),Object(S.jsx)("th",{style:{width:"5%"},children:"Remove"})]})}),Object(S.jsx)("tbody",{children:e.RaidActivity.map((function(e,t){return Object(S.jsxs)("tr",{style:{fontSize:"1.3rem"},children:[Object(S.jsx)("td",{className:"lfm-number",children:e.name}),Object(S.jsx)("td",{children:q(e)}),Object(S.jsx)("td",{children:Object(S.jsx)(g.a,{className:"fading-icon",onClick:function(){I(!0),D(e.id)}})})]},t)}))})]})]})}),Object(S.jsx)("hr",{style:{backgroundColor:"var(--text)",opacity:.2,margin:"5px 3px"}}),t==d.length-1&&Object(S.jsx)("div",{style:{height:"20px"}})]},t)})),m&&null==d&&Object(S.jsx)("div",{style:{minHeight:"150px",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(S.jsx)("span",{style:{textAlign:"center",fontSize:"1.5rem"},children:"Loading..."})})]})},R=i(60);t.default=function(e){var t=a.a.useState(!1),i=Object(n.a)(t,2),r=i[0],f=i[1],x=a.a.useState(!1),p=Object(n.a)(x,2),g=p[0],O=p[1],y=a.a.useState(!1),v=Object(n.a)(y,2),w=v[0],N=v[1],A=a.a.useState(null),T=Object(n.a)(A,2),C=T[0],I=T[1];function F(e){null!=e?(Object(o.b)("Feature: Raid Timers",e),I("Like"===e?"positive":"negative")):(I("close"),O(!1)),N(!0),localStorage.setItem("feature-vote-raid-timers",new Date)}return a.a.useEffect((function(){localStorage.getItem("hide-raid-timer-disclaimer")?f(!1):f(!0);var e=localStorage.getItem("feature-vote-raid-timers");JSON.parse(localStorage.getItem("registered-characters")||"[]").length>0&&null==e&&O(!0)}),[]),Object(S.jsxs)("div",{children:[Object(S.jsxs)(c.a,{children:[Object(S.jsx)("title",{children:"Raid Timers"}),Object(S.jsx)("meta",{name:"description",content:"Check raid timers for all of your characters before you log in!"}),Object(S.jsx)("meta",{property:"og:image",content:"/icons/logo-512px.png","data-react-helmet":"true"}),Object(S.jsx)("meta",{property:"twitter:image",content:"/icons/logo-512px.png","data-react-helmet":"true"})]}),Object(S.jsx)(l.a,{small:!0,showTitle:!0,showSubtitle:!0,showButtons:!1,hideOnMobile:!0,hideVote:!0,title:"Raid Timers",subtitle:"Check Raid Timers"}),Object(S.jsxs)("div",{className:"content-container",children:[Object(S.jsx)(j.a,{page:"timers"}),Object(S.jsx)(R.a,{classification:"inferred"}),Object(S.jsx)("div",{className:"top-content-padding-small shrink-on-mobile"}),Object(S.jsx)(b.a,{}),Object(S.jsxs)(m.a,{title:"Raid Timers",description:"View your characters' current raid timers based on questing activity.",children:[Object(S.jsx)(k,{}),Object(S.jsx)("div",{style:{display:"flex"},children:Object(S.jsx)(s.a,{className:"primary-button should-invert",to:"/registration",children:"Manage characters"})}),g&&Object(S.jsx)("div",{className:"feature-vote-container",style:{opacity:w?1:""},children:w?Object(S.jsx)(S.Fragment,{children:Object(S.jsx)("span",{style:{cursor:"default"},children:"positive"===C?"That's great to hear! Thanks.":Object(S.jsxs)(S.Fragment,{children:["Have a moment to"," ",Object(S.jsx)(s.a,{to:"/suggestions",children:"suggest an improvement"}),"?"]})})}):Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("span",{style:{cursor:"default"},children:"Is this feature useful?"}),Object(S.jsx)(u.a,{className:"nav-icon should-invert",style:{cursor:"pointer"},onClick:function(){return F("Like")}}),Object(S.jsx)(d.a,{className:"nav-icon should-invert",style:{cursor:"pointer"},onClick:function(){return F("Dislike")}}),Object(S.jsx)(h.a,{className:"nav-icon should-invert",style:{cursor:"pointer"},onClick:function(){return F(null)}})]})})]}),r&&Object(S.jsx)(m.a,{title:"Please Note",noLink:!0,description:Object(S.jsxs)("span",{children:[Object(S.jsx)("p",{children:"The raid timers displayed here are estimates and come with the following caveats:"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"The timer begins the moment your character leaves a raid, whether or not the raid was completed."}),Object(S.jsx)("li",{children:"The timer starts even if you forget to claim your reward from the quest giver."}),Object(S.jsx)("li",{children:"There is no way to account for the use of Raid Timer Bypass Hourglasses."}),Object(S.jsx)("li",{children:"There is no distinction between legendary and heroic versions of a raid."}),Object(S.jsxs)("li",{children:["Some raids may not be tracked. If you find one,"," ",Object(S.jsx)(s.a,{to:"/suggestions",children:"let me know"}),"."]})]})]}),noFade:!0,children:Object(S.jsx)("div",{className:"secondary-button should-invert",onClick:function(){f(!1),localStorage.setItem("hide-raid-timer-disclaimer",!0),Object(o.a)("Dismissed disclaimer","Raid timers")},children:"Dismiss"})})]})]})}}}]);
//# sourceMappingURL=6.6da40f25.chunk.js.map